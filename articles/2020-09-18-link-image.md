---
title: 記事内の画像にリンクを付けた
---

これで画像をクリックすると大きく表示できるようになった。

![](/images/2020-09-18-link-image.jpg)

特に脈絡の無いサメのぬいぐるみの画像。

もともとこのウェブサイトの記事本文のHTMLは、Markdownで書かれた文字列をHTML形式の木構造に変換し、それを文字列として埋め込む、という方法で生成されていた。今回はこの処理の途中に少し手を加え、木構造に含まれるimg要素をa要素で囲む、という処理を加えることにした。

https://github.com/r7kamura/r7kamura.com/pull/11

具体的には、木構造に変換フィルター群を適用して別の木構造にしていく、というパターンで実装している。こういうのは独自記法を実装するときの常套手段で、例えばQiitaやQiita:TeamのMarkdownパーサーなんかも同じ仕組みで実装されている。

当時、emojiやmention、他の記事への言及、外部リンク、シンタックスハイライトやタスクリストなど、Markdownパーサの仕事は日に日に増えつつあり、この要求に耐え得るべく2014年頃に自分が実装し直したものがこれで、今でもまだ元気に動いているはず。

https://github.com/increments/qiita-markdown
